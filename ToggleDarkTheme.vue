<script>
export default {
  name: "ToggleDarkTheme",
  props: {
    buttons: {
      type: Object,
      default: function () {
        return {
          "dark": "Dark mode",
          "light": "Light mode",
        };
      },
    },
    colors: {
      type: Object,
      default: function () {
        return {
          "dark": "#0b2137",
          "light": "#ffffff",
        };
      },
    },
  },
  data: function () {
    return {
      isDarkMode: false,
      storageName: 'dark-mode',
      themeMode: this.isDarkMode ? 'dark' : 'light'
    };
  },
  methods: {
    toggleThemeMode() {
      this.isDarkMode = !this.isDarkMode;
      this.changeThemeMode();
    },
    changeThemeMode() {
      let mode = this.isDarkMode ? 'dark' : 'light';
      let bodyClass = document.querySelector('body').classList;

      if (mode == 'dark') {
        bodyClass.remove('light');
        bodyClass.add('dark');
      } else {
        bodyClass.remove('dark');
        bodyClass.add('light');
      }

      this.setToStorage(this.isDarkMode);
      this.changeMetaColor();
    },
    changeMetaColor() {
      let color = this.isDarkMode ? this.colors.dark : this.colors.light;
      document
        .querySelector("meta[name=theme-color]")
        .setAttribute("content", color);
    },
    getFromStorage() {
      return localStorage.getItem(this.storageName);
    },
    setToStorage(value) {
      localStorage.setItem(this.storageName, value);
    },
  },
  created() {
    let themeModeFromStorage = this.getFromStorage();

    if (themeModeFromStorage === null) {
      this.isDarkMode = window.matchMedia(
        "(prefers-color-scheme: dark)"
      ).matches;
    } else {
      this.isDarkMode = JSON.parse(themeModeFromStorage);
    }

    this.changeThemeMode();
  },
};
</script>

<template>
  <span class="theme-mode-toggle" @click="toggleThemeMode()">
    <svg class="pictire" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" fill="none"><path d="M8.00008 11.3334C7.07786 11.3334 6.29186 11.0083 5.64208 10.3581C4.99186 9.7083 4.66675 8.9223 4.66675 8.00008C4.66675 7.07786 4.99186 6.29164 5.64208 5.64141C6.29186 4.99164 7.07786 4.66675 8.00008 4.66675C8.9223 4.66675 9.70853 4.99164 10.3587 5.64141C11.0085 6.29164 11.3334 7.07786 11.3334 8.00008C11.3334 8.9223 11.0085 9.7083 10.3587 10.3581C9.70853 11.0083 8.9223 11.3334 8.00008 11.3334ZM1.33341 8.66675C1.14453 8.66675 0.986304 8.60275 0.858748 8.47475C0.730748 8.34719 0.666748 8.18897 0.666748 8.00008C0.666748 7.81119 0.730748 7.65275 0.858748 7.52475C0.986304 7.39719 1.14453 7.33342 1.33341 7.33342H2.66675C2.85564 7.33342 3.01408 7.39719 3.14208 7.52475C3.26964 7.65275 3.33341 7.81119 3.33341 8.00008C3.33341 8.18897 3.26964 8.34719 3.14208 8.47475C3.01408 8.60275 2.85564 8.66675 2.66675 8.66675H1.33341ZM13.3334 8.66675C13.1445 8.66675 12.9863 8.60275 12.8587 8.47475C12.7307 8.34719 12.6667 8.18897 12.6667 8.00008C12.6667 7.81119 12.7307 7.65275 12.8587 7.52475C12.9863 7.39719 13.1445 7.33342 13.3334 7.33342H14.6667C14.8556 7.33342 15.0139 7.39719 15.1414 7.52475C15.2694 7.65275 15.3334 7.81119 15.3334 8.00008C15.3334 8.18897 15.2694 8.34719 15.1414 8.47475C15.0139 8.60275 14.8556 8.66675 14.6667 8.66675H13.3334ZM8.00008 3.33341C7.81119 3.33341 7.65297 3.26941 7.52541 3.14141C7.39742 3.01386 7.33342 2.85564 7.33342 2.66675V1.33341C7.33342 1.14453 7.39742 0.986081 7.52541 0.858081C7.65297 0.730526 7.81119 0.666748 8.00008 0.666748C8.18897 0.666748 8.34741 0.730526 8.47542 0.858081C8.60297 0.986081 8.66675 1.14453 8.66675 1.33341V2.66675C8.66675 2.85564 8.60297 3.01386 8.47542 3.14141C8.34741 3.26941 8.18897 3.33341 8.00008 3.33341ZM8.00008 15.3334C7.81119 15.3334 7.65297 15.2694 7.52541 15.1414C7.39742 15.0139 7.33342 14.8556 7.33342 14.6667V13.3334C7.33342 13.1445 7.39742 12.9863 7.52541 12.8587C7.65297 12.7307 7.81119 12.6667 8.00008 12.6667C8.18897 12.6667 8.34741 12.7307 8.47542 12.8587C8.60297 12.9863 8.66675 13.1445 8.66675 13.3334V14.6667C8.66675 14.8556 8.60297 15.0139 8.47542 15.1414C8.34741 15.2694 8.18897 15.3334 8.00008 15.3334ZM3.76675 4.70008L3.05008 4.00008C2.91675 3.87786 2.85275 3.7223 2.85808 3.53341C2.86386 3.34453 2.92786 3.18341 3.05008 3.05008C3.18341 2.91675 3.34453 2.85008 3.53341 2.85008C3.7223 2.85008 3.87786 2.91675 4.00008 3.05008L4.70008 3.76675C4.8223 3.90008 4.88341 4.05564 4.88341 4.23341C4.88341 4.41119 4.8223 4.56675 4.70008 4.70008C4.57786 4.83342 4.42519 4.89719 4.24208 4.89141C4.05853 4.88608 3.90008 4.8223 3.76675 4.70008ZM12.0001 12.9501L11.3001 12.2334C11.1779 12.1001 11.1167 11.9419 11.1167 11.7587C11.1167 11.5752 11.1779 11.4223 11.3001 11.3001C11.4223 11.1667 11.5752 11.103 11.7587 11.1087C11.9419 11.1141 12.1001 11.1779 12.2334 11.3001L12.9501 12.0001C13.0834 12.1223 13.1474 12.2779 13.1421 12.4667C13.1363 12.6556 13.0723 12.8167 12.9501 12.9501C12.8167 13.0834 12.6556 13.1501 12.4667 13.1501C12.2779 13.1501 12.1223 13.0834 12.0001 12.9501ZM11.3001 4.70008C11.1667 4.57786 11.103 4.42497 11.1087 4.24141C11.1141 4.0583 11.1779 3.90008 11.3001 3.76675L12.0001 3.05008C12.1223 2.91675 12.2779 2.85275 12.4667 2.85808C12.6556 2.86386 12.8167 2.92786 12.9501 3.05008C13.0834 3.18341 13.1501 3.34453 13.1501 3.53341C13.1501 3.7223 13.0834 3.87786 12.9501 4.00008L12.2334 4.70008C12.1001 4.8223 11.9445 4.88341 11.7667 4.88341C11.589 4.88341 11.4334 4.8223 11.3001 4.70008ZM3.05008 12.9501C2.91675 12.8167 2.85008 12.6556 2.85008 12.4667C2.85008 12.2779 2.91675 12.1223 3.05008 12.0001L3.76675 11.3001C3.90008 11.1779 4.05853 11.1167 4.24208 11.1167C4.42519 11.1167 4.57786 11.1779 4.70008 11.3001C4.83342 11.4223 4.89741 11.5752 4.89208 11.7587C4.8863 11.9419 4.8223 12.1001 4.70008 12.2334L4.00008 12.9501C3.87786 13.0834 3.7223 13.1472 3.53341 13.1414C3.34453 13.1361 3.18341 13.0723 3.05008 12.9501Z" fill="currentColor"></path></svg>

    {{ isDarkMode ? buttons.dark : buttons.light }}
  </span>
</template>

<style lang="scss">
.theme-mode-toggle {
  display: flex;
  flex-flow: row wrap;
  align-items: center;
  color: var(--a-color);
  transition: all 0.5s ease;
  cursor: pointer;

  &:hover {
    color: var(--a-color-hover);
  }

  .pictire {
    margin-right: 6px;
  }
}
</style>
